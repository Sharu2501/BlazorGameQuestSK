@namespace BlazorGame.Client.Pages
@page "/game"

<link rel="stylesheet" href="css/room.css" />
<link rel="stylesheet" href="css/game.css" />

@if (isLoading)
{
    <div class="loading-container">
        <p>GÃ©nÃ©ration du donjon...</p>
    </div>
}
else if (gameState != null)
{
    <div class="salle-container" style="background-image: url('@GetRoomImage()')">
        <div class="salle-content">
            <img src="images/logo.png" class="room-logo" />

            <div class="dungeon-info">
                <h2>@gameState.CurrentDungeon?.Name</h2>
                <p class="dungeon-desc">@gameState.CurrentDungeon?.Description</p>
                <p>Salle @(gameState.CurrentRoomIndex + 1) / @gameState.TotalRooms</p>
                <p>DifficultÃ©: @GetDifficultyName(gameState.DifficultyLevel)</p>
            </div>

            <h3>@gameState.CurrentRoom?.Name</h3>
            <p>@gameState.CurrentRoom?.Description</p>

            @if (gameState.CurrentRoom?.Monster != null && !gameState.IsMonsterDefeated)
            {
                <div class="monster-info">
                    <h4>âš”ï¸ @gameState.CurrentRoom.Monster.Name (Niveau @gameState.CurrentRoom.Monster.Level)</h4>
                    <div class="monster-stats">
                        <span>â¤ï¸ PV: @gameState.CurrentRoom.Monster.Health</span>
                        <span>âš”ï¸ ATQ: @gameState.CurrentRoom.Monster.Attack</span>
                        <span>ğŸ›¡ï¸ DEF: @gameState.CurrentRoom.Monster.Defense</span>
                    </div>
                </div>
            }

            <div class="actions">
                @foreach (var action in GetAvailableActions())
                {
                    <button @onclick="@(() => ExecuteAction(action))" disabled="@IsActionDisabled(action)">@action</button>
                }
            </div>

            <div class="heal-potions">
                <span>ğŸ§ª Potions de soin: </span>
                @for (int i = 0; i < gameState.MaxHealPerRoom; i++)
                {
                    @if (i < gameState.HealUsedInRoom)
                    {
                        <span class="potion-used">âš«</span>
                    }
                    else
                    {
                        <span class="potion-available">ğŸŸ¢</span>
                    }
                }
            </div>

            <p class="message">@message</p>

            <div class="player-stats">
                <h4>ğŸ“Š Statistiques de @PlayerStats?.Username</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">â¤ï¸ PV:</span>
                        <span class="stat-value">@PlayerStats?.Health / @PlayerStats?.MaxHealth</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">âš”ï¸ ATQ:</span>
                        <span class="stat-value">@PlayerStats?.Attack</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ›¡ï¸ DEF:</span>
                        <span class="stat-value">@PlayerStats?.Defense</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ’° Or:</span>
                        <span class="stat-value">@PlayerStats?.Gold</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">â­ Score:</span>
                        <span class="stat-value">@gameState.Score</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ“ˆ Niveau:</span>
                        <span class="stat-value">@PlayerStats?.Level</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
}