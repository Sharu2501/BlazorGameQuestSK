@namespace BlazorGame.Client.Pages
@page "/game"

<link rel="stylesheet" href="css/room.css" />
<link rel="stylesheet" href="css/game.css" />

@if (isLoading)
{
    <div class="loading-container">
        <p>GÃ©nÃ©ration du donjon...</p>
    </div>
}
else if (gameState != null)
{
    <div class="salle-container" style="background-image: url('@GetRoomImage()')">
        <div class="salle-content">
            <img src="images/logo.png" class="room-logo" />

            <div class="dungeon-info">
                <h2>@gameState.CurrentDungeon?.Name</h2>
                <p class="dungeon-desc">@gameState.CurrentDungeon?.Description</p>
                <p>Salle @(gameState.CurrentRoomIndex + 1) / @gameState.TotalRooms</p>
                <p>DifficultÃ©: @GetDifficultyName(gameState.DifficultyLevel)</p>
            </div>

            <div class="battle-container">
                <div class="player-stats-side">
                    <h4 style="color:limegreen;"> @PlayerStats?.Username</h4>
                    <div class="stats-box green-bg">
                        <div class="stat-item">â¤ï¸ PV: @PlayerStats?.Health / @PlayerStats?.MaxHealth</div>
                        <div class="stat-item">âš”ï¸ ATQ: @PlayerStats?.Attack</div>
                        <div class="stat-item">ğŸ›¡ï¸ DEF: @PlayerStats?.Defense</div>
                        <div class="stat-item">ğŸ’° Or: @PlayerStats?.Gold</div>
                        <div class="stat-item">ğŸ“ˆ Niveau: @PlayerStats?.Level</div>
                    </div>
                </div>

                <div class="battle-messages">
                    <div class="battle-message">@message</div>
                </div>

                @if (gameState.CurrentRoom?.Monster != null)
                {
                    <div class="monster-stats-side">
                        <h4 style="color:#fc4343;">ğŸ‘¾ @gameState.CurrentRoom.Monster.Name</h4>
                        <div class="stats-box red-bg">
                            <div class="stat-item">â¤ï¸ PV: @gameState.CurrentRoom.Monster.Health</div>
                            <div class="stat-item">âš”ï¸ ATQ: @gameState.CurrentRoom.Monster.Attack</div>
                            <div class="stat-item">ğŸ›¡ï¸ DEF: @gameState.CurrentRoom.Monster.Defense</div>
                            <div class="stat-item">ğŸ“ˆ Niveau: @gameState.CurrentRoom.Monster.Level</div>
                        </div>
                    </div>
                }
            </div>

            <div class="actions">
                @foreach (var action in GetAvailableActions())
                {
                    <button @onclick="@(() => ExecuteAction(action))" disabled="@IsActionDisabled(action)">@action</button>
                }
            </div>

            <div class="heal-potions">
                <span>ğŸ§ª Potions de soin: </span>
                @for (int i = 0; i < gameState.MaxHealPerRoom; i++)
                {
                    @if (i < gameState.HealUsedInRoom)
                    {
                        <span class="potion-used">âš«</span>
                    }
                    else
                    {
                        <span class="potion-available">ğŸŸ¢</span>
                    }
                }
            </div>
        </div>
    </div>
}